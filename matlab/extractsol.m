% EXTRACTSOL - Extracts all variables from the state matrix sol%%  M. den Toom%function [u,v,w,p,T,S] = extractsol(sol,varargin)%fprintf(1,'Splitting state matrix...\n')%% - EXTRACT VARIABLES -if ndims(sol)==4    u = squeeze(sol(1,:,:,:));    v = squeeze(sol(2,:,:,:));    w = squeeze(sol(3,:,:,:));    p = squeeze(sol(4,:,:,:));    T = squeeze(sol(5,:,:,:));    S = squeeze(sol(6,:,:,:));else    if isempty(varargin)        eigvnr = 1;        fprintf(1,'-- select first eigenvector\n')    else        eigvnr = varargin(1);    end    u = squeeze(sol(1,:,:,:,eigvnr));    v = squeeze(sol(2,:,:,:,eigvnr));    w = squeeze(sol(3,:,:,:,eigvnr));    p = squeeze(sol(4,:,:,:,eigvnr));    T = squeeze(sol(5,:,:,:,eigvnr));    S = squeeze(sol(6,:,:,:,eigvnr));end