% gridstretch - Finds out what qz is, and gives dfzt and dfzw%%  M. den Toom%function [qz,dfzt,dfzw] = gridstretch(zw)%% - Extract grid detailsdiffz = diff(zw);l     = length(zw)-1;dz    = (zw(l+1)-zw(1))/l;ze    = (0.5:1:l-0.5)'*dz+zw(1);zwe   = (0:1:l)'*dz    +zw(1); %% - Computationif(diffz(1)>diffz(2))    i    = 0;    qz   = 1.0;    while i<1000;        i  = i+1;        up = (zw(l)-fz(zwe(l),qz))/dfdz(zwe(l),qz);        qz = qz + up;        if (up<1e-6); break; end    end    qz   = smartround(qz,4);    dfzt = dfdz(ze,qz);    dfzw = dfdz(zwe,qz);else    qz   = 1;    dfzt = ones(l,1);    dfzw = ones(l+1,1);end